# XJF2332的工具箱

自用小工具集合~

---

## 依赖

个人开发环境用的是 Python3.11.9

python库依赖：

- charset_normalizer
- colorama
- gradio
- matplotlib
- numpy
- pandas
- pillow
- pyperclip
- pyside6
- send2trash
- tqdm
- win10toast

外部工具依赖：

- ffmpeg
- everything及其命令行工具es
- ComfyUI

## 功能说明

---

### CLI

---

#### APNG、WebP转GIF.py

把 APNG、WebP 格式的图片转成 GIF，转换使用了 ffmpeg，你需要有可用的 ffmpeg

**输入**

- string：图片文件夹路径
- y/n：是否递归遍历目录
- y/n：是否发送原文件到回收站
- int：GIF 质量

**输出**

- 原文件夹中的同名 GIF 文件

> 为什么为什么为什么，为什么 ComfyUI 你文生视频不是 MP4

---

#### ComfyUI-Upscale.py

利用 ComfyUI 的 API 进行图片放大，你需要先有一个可用的正在运行的 ComfyUI 服务。

**输入**

- string：ComfyUI 放大模型路径
- int：模型文件序号
- string：图片文件夹路径
- int：图片的长、宽和大小阈值，低于其中任意一个值的图片都会被放大
- float：放大后图片的缩小比例
- int：ComfyUI 端口号
- float：查询间隔，多久查询一次任务状态

**选项**
1. 自动查找：根据设置的阈值决定是否要放大
2. 手动指定：输入一个图片路径，或者输入一个文本文件，它的每一行都是一个路径，脚本会从这个文件中读取路径并发送给ComfyUI。手动模式下阈值设置不生效
3. 删除图片文件：删除那些小于阈值的图片，建议在 ComfyUI 处理完后再删除
4. 重新获取参数：这个还需要解释吗(≧∀≦)ゞ（其实更像是返回）

**注意事项**
- 脚本在遇到疑似长图的图片时会询问是否要保留
- 脚本会丢弃包含透明度的图片，因为 AI 不能放大这些图片
- 脚本不会放大 gif 图片，因为对每一帧都进行放大消耗太大了

> 我做这玩意是因为我总是从网上收很多图，有些足够清晰不用放大，有些则需要，于是为了方便我搞放大，就做了这个玩意

---

#### JSON键值对排序.py

把 JSON 文件的键按照字母顺序排序

**输入**

- string：JSON 文件路径

**输出**

- 覆盖原文件

> 我给其他项目做 Locale 时往 JSON 里塞的键值对一般是乱的，但我又需要排序来方便查找，就有了这个东西

---

#### PNG转JPG.py

把指定目录的PNG图像转成JPG，默认是最高质量

**输入**

- string：图片文件夹路径
- y/n：是否删除原始 PNG 图像
- int：JPEG 质量
- y/n：是否转换含有透明度的图像
- y/n：是否保留元数据

**输出**

- 原文件夹中的同名 JPG 文件

> ComfyUI 放大出来一大堆 PNG 占一堆空间，就有了它  
> 保留元数据不能保留 ComfyUI 工作流，我也不知道为什么，明明都读出来了就是写不进去

---

#### Unicode转义转字符.py

把 Unicode 转义转成字符

**输入**

- string：输入文件路径
- string：输出文件路径
- regex：匹配模式

**输出**

- 文件

> 跟另一个repo（Text-Generation-Webui）有关，以前的版本会把聊天记录中的非ASCII字符存成Unicode转义，但新版不会了。虽然新版也能向下兼容，但我还是想电脑里的聊天记录人也能看

---

#### 删除重复行.py

删除文本文件中的重复行，保留原始顺序

**输入**

- string：输入文件路径

**输出**

- 原文件夹中的同名`_no_duplicates.txt`文件

> 我就直说了吧，Windows 的新媒体播放器就是拉了一坨大的，那播放列表管理简直就是一堆很奇怪的就能跑起来的 bug

---

#### 包更新安全性检查.py

根据 pipdeptree 输出的 json 文件（不是`--reverse`的），检查更新特定包是否可能带来兼容性问题

---

#### 卸载包.py

根据 requirements.txt 文件卸载包

> 一时脑抽做的，到现在还没用过一次

---

---

#### 去除requirements版本号.py

去除 requirements.txt 文件中的版本号

**输入**
- requirements.txt 文件路径

**输出**
- 保存为脚本所在目录下的 requirements-noversion.txt 文件

> 其实是为了我的另一个repo（GOT-OCR-2-GUI）做的工具

---

#### 按正则表达式删除文件.py

删除（发送到回收站）指定目录下符合特定正则表达式的文件

**输入**
- 文件夹路径
- 正则表达式

**输出**
- 无

> 做课程实验的时候，我得用 Camera Raw 处理一些图，但它 AI 降噪后会生成一个新图，为了方便我删除旧图，我就写了这个

---

#### 按正则表达式删除空文件夹.py

删除（发送到回收站）指定目录下符合特定正则表达式的空文件夹

**输入**
- 文件夹路径
- 正则表达式

**输出**
- 无

> 做上面那玩意顺便做的

---

#### 根据文档复制文件.py

提供一个 txt 文档，它的每一行都应该是一个文件路径，然后把每一行的文件路径都复制到 temp 文件夹里

**输入**
- 文档路径

**输出**
- temp 文件夹

> 想把电脑上的音乐传到手机上，于是就有了这个东西（因为.m3u8播放列表本质上就是一个文档）

---

#### 画师串抽卡工具.py

你需要先有一个画师串 JSON，推荐从 KohakuXL Delta 那里去找。

**输入**
- JSON 路径
- 抽取的数量

**输出**
- 复制到剪贴板 

> 想用 Kohaku 模型但是不会写画师串？这下只能抽卡了😭

#### 单文件文件夹整理
递归查找指定目录，如果有一个目录下只有一个文件，且没有子文件夹，则把这个文件从原文件夹移动到父文件夹，重命名为原文件夹的名字，然后删除原文件夹，直到没有任何符合要求的目录为止

**输入**
- 文件夹路径

**输出**
- 无

---

### Gradio

GUI 的输入输出应该都很清楚吧ヾ(≧▽≦*)o

#### 志愿时长计算.py

算志愿活动时长的
> 暑假去做志愿活动，结束时要算时长，刚好当时在学 Gradio，就做了这个

---

#### 按正则表达式删除文件-gr.py

删除指定目录下符合特定正则表达式的文件
> 说真的就这点破事真的有必要等 Gradio 加载半天吗？Gradio 打开的时间我用 CLI 都能删完了

---

#### 距离计算.py

> 我为什么要做这个

---

### PySide6

GUI 的输入输出应该都很清楚吧ヾ(≧▽≦*)o

#### 志愿时长计算.py

算志愿活动时长的
> 跟上面那玩意是一个东西，不过这个是玩 LLM 顺便让 AI 做的

---

#### 日期计算器.py

算一个日期过几天后的日期
> 我做这个是想干啥来着？

---

#### 过期计算.py
算保质期的
> 都什么年代了，还在手算保质期？

#### PNG转JPG.py
跟上头CLI里那个干的是一样的活，只不过GUI好看些

#### 按正则表达式删除文件
跟上头CLI里那个干的是一样的活，只不过GUI好看些

---

### Tkinter

GUI 的输入输出应该都很清楚吧ヾ(≧▽≦*)o

#### Base64.py
编解码 Base64 的
> 一时兴起就做了......

---

#### 百分差计算器.py
算两个数的百分差的
> 上物理实验课要算一堆百分差，索性直接做了一个脚本

---

#### 距离计算.py
> 我为什么要做这个

---

### 没啥用的小玩意

这些脚本存在的意义是什么？